<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORENG - Kirim Karya</title>
<link rel="stylesheet" href="style.css">
<style>
form{max-width:600px;margin:20px auto;display:flex;flex-direction:column;gap:10px;}
input,textarea,select,button{padding:8px;font-size:14px;border-radius:5px;border:1px solid #ccc;width:100%;}
button{background-color:#2c3e50;color:white;cursor:pointer;}
button:hover{background-color:#34495e;}

#previewCard{
  border:1px solid #ccc;
  padding:15px;
  margin:20px auto;
  border-radius:10px;
  max-width:600px;
  display:none;
  background-color:#f4e6cd;
  color:#3a2518;
}
#previewCard h3{font-family:'Playfair Display', serif;margin:0;}
#previewCard small{color:#6e4b2e;}
#previewCard p{margin-top:10px;}
</style>
</head>
<body>

<nav>
  <div class="logo">CORENG</div>
  <div>
    <a href="index.html">Beranda</a>
    <a href="puisi.html">Puisi</a>
    <a href="cerpen.html">Cerpen</a>
    <a href="likhati.html">Likhati</a>
    <a href="kirim.html">Kirim Karya</a>
    <a href="penulis.html">Penulis</a>
  </div>
</nav>

<section>
  <h1>Kirim Karya</h1>
  <form id="kirimForm">
    <input type="text" id="nama" placeholder="Nama Penulis" required>
    <select id="jenis" required>
      <option value="">-- Pilih Jenis Karya --</option>
      <option value="Puisi">Puisi</option>
      <option value="Cerpen">Cerpen</option>
      <option value="Likhati">Likhati</option>
    </select>
    <input type="text" id="judul" placeholder="Judul Karya" required>
    <textarea id="isi" rows="8" placeholder="Isi karya..." required></textarea>
    <input type="text" id="link" placeholder="Link (opsional)">
    <input type="text" id="bio" placeholder="Bio Penulis (opsional)">
    <input type="text" id="foto" placeholder="URL Foto Profil (opsional)">
    <button type="submit">Kirim Karya</button>
  </form>
</section>

<section id="previewCard">
  <h3 id="previewJudul"></h3>
  <small id="previewMeta"></small>
  <p id="previewIsi"></p>
</section>

<script>
const url = "https://script.google.com/macros/s/AKfycbwAYPlfKkUQk3-uQUC1XUxUQ-3hqDG2qZWuw0vdOc1ZkGpu8BJe0446yNZUBs0yGL9RPw/exec";

const namaInput=document.getElementById("nama");
const jenisInput=document.getElementById("jenis");
const judulInput=document.getElementById("judul");
const isiInput=document.getElementById("isi");

const previewCard=document.getElementById("previewCard");
const previewJudul=document.getElementById("previewJudul");
const previewMeta=document.getElementById("previewMeta");
const previewIsi=document.getElementById("previewIsi");

function updatePreview(){
  const nama=namaInput.value.trim();
  const jenis=jenisInput.value;
  const judul=judulInput.value.trim();
  const isi=isiInput.value.trim();
  if(judul||isi){
    previewCard.style.display="block";
    previewJudul.innerText=judul||"[Judul]";
    previewMeta.innerText=`${jenis||"[Jenis]"} | ${nama||"[Nama]"}`;
    previewIsi.innerText=isi.substring(0,200)+(isi.length>200?"...":"");
  } else { previewCard.style.display="none"; }
}

[namaInput,jenisInput,judulInput,isiInput].forEach(el=>el.addEventListener("input",updatePreview));

document.getElementById("kirimForm").addEventListener("submit",function(e){
  e.preventDefault();
  const nama=namaInput.value.trim();
  const jenis=jenisInput.value;
  const judul=judulInput.value.trim();
  const isi=isiInput.value.trim();
  const link=document.getElementById("link").value.trim();
  const bio=document.getElementById("bio").value.trim();
  const foto=document.getElementById("foto").value.trim();
  if(!nama||!jenis||!judul||!isi){ alert("Nama, Jenis, Judul, dan Isi wajib diisi!"); return; }

  const data={action:"addKarya",nama,nama,jenis,judul,isi,link,bio,foto};

  fetch(url,{method:"POST",body:JSON.stringify(data)})
    .then(res=>res.json())
    .then(res=>{
      if(res.status=="success"){ alert("Karya berhasil dikirim!"); document.getElementById("kirimForm").reset(); previewCard.style.display="none"; }
      else{ alert("Gagal mengirim karya."); }
    });
});
</script>

</body>
</html>
